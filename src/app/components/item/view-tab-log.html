<div class="rowfree sell-transactions">
    <div class="item-transaction-section">
        <p style="text-align: left; margin: 10px 0 0 100px;">2 items sold 3 left</p>
        <br>

        <div ng-if="item.itemSells.length>0" class="current-transaction" ui-tree data-drag-enabled="false">
            <ol ui-tree-nodes="" ng-model="item.itemSells">
                <li ng-repeat="isell in item.itemSells track by isell.id" ui-tree-node collapsed="true">
                    <div ng-click="toggle(this)" ui-tree-handle class="first-transaction">
                        <div class="left">
                            <a class="hideLink arrow-position">&nbsp;</a>
                        </div>
                        <div class="right">
                            <div>{{isell.itemSellTransactions[isell.itemSellTransactions.length-1].status |
                                itemTransactionStatus}}
                            </div>
                            <img class="profile-in-transaciton"
                                 ng-src="{{isell.buyer.avatar_url}}">
                        </div>
                    </div>
                    <ol ui-tree-nodes="" ng-model="isell.itemSellTransactions" ng-class="{hidden: collapsed}">
                        <li ng-repeat="subIsell in isell.itemSellTransactions  | orderBy:'-created_at' track by subIsell.id"
                            ui-tree-node
                            data-collapsed="true"
                            ng-if="subIsell.status | itemTransactionStatusVisibility">
                            <div class="transaction-section-container past-transaction"
                                 ui-tree-handle ng-class="{accepted: subIsell.status === transactionStates.accepted}">
                                <div ng-if="subIsell.status !== transactionStates.accepted" class="left">
                                    <a class="hideLink arrow-position" ng-click="toggle(this)">&nbsp;</a>
                                </div>
                                <div class="right">
                                    <div ng-click="toggle(this)" ng-if="subIsell.status !== transactionStates.accepted">
                                        {{subIsell.status |
                                        itemTransactionStatus}}
                                        <f6>{{subIsell.created_at | amCalendar}}</f6>
                                    </div>
                                    <p ng-if="subIsell.status === transactionStates.accepted">Well done on your
                                        successful sale. The balance of <b>$134</b> is now able to be spent on other
                                        items in Mobbbi and will be avialable to cash out in <b>10</b> days.</p>

                                    <div class="subtransaction-more-container" ng-class="{hidden: collapsed}">
                                        <!--Hurryup state-->
                                        <div ng-if="subIsell.status==transactionStates.hurryup &&
                                         (isell.itemSellTransactions[isell.itemSellTransactions.length-1].status>transactionStates.arrived
                                         && isell.itemSellTransactions[isell.itemSellTransactions.length-1].status<=transactionStates.accepted)">
                                            <f6>Please hurry up with your transaction and help us run a service that is
                                                quick and efficient for our buys and sellers. Thank you.
                                            </f6>
                                            <!--TODO: remove in production-->
                                            <div ng-click="changeItemStatus(isell.id, transactionStates.accepted)">^
                                            </div>
                                        </div>
                                        <!--Hurryup state-->
                                        <!--Arrived state-->
                                        <div ng-if="subIsell.status==transactionStates.arrived &&
                                         (isell.itemSellTransactions[isell.itemSellTransactions.length-1].status>transactionStates.receivedInPost
                                         && isell.itemSellTransactions[isell.itemSellTransactions.length-1].status<=transactionStates.accepted)">
                                            <f6>Your item is with buyer. We will let you know as soon as it gets
                                                approval: <b>Delivered in Michigan 36001</b></f6>
                                            <!--TODO: remove in production-->
                                            <div ng-click="changeItemStatus(isell.id, transactionStates.hurryup)">^
                                            </div>
                                        </div>
                                        <!--Arrived state-->
                                        <!--Received in post state-->
                                        <div ng-if="subIsell.status==transactionStates.receivedInPost &&
                                         (isell.itemSellTransactions[isell.itemSellTransactions.length-1].status>transactionStates.label
                                         && isell.itemSellTransactions[isell.itemSellTransactions.length-1].status<=transactionStates.accepted)">
                                            <f6>Your shipping label was scanned at: <b>Eagle Rock 90065</b></f6>
                                            <!--TODO: remove in production-->
                                            <div ng-click="changeItemStatus(isell.id, transactionStates.arrived)">^
                                            </div>
                                        </div>
                                        <!--Received in post state-->
                                        <!--Send item state-->
                                        <div ng-if="subIsell.status==transactionStates.send && isell.itemSellTransactions[isell.itemSellTransactions.length-1].status==transactionStates.send">
                                            <f6>Attach label to a <b>Medium size box</b></f6>
                                            <div>
                                                <div ng-if="isell.itemSellTransactions[isell.itemSellTransactions.length-1].status==transactionStates.send"
                                                     class="btn btn-buy centered btn-label"
                                                     ng-click="changeItemStatus(isell.id, transactionStates.label)">Get
                                                    a Shipping Label
                                                </div>
                                            </div>
                                            <f6>And give the box to your mailman asap.</f6>
                                            <!--TODO: remove in production-->
                                            <div ng-click="changeItemStatus(isell.id, transactionStates.receivedInPost)">
                                                ^
                                            </div>
                                        </div>
                                        <div ng-if="subIsell.status==transactionStates.send &&
                                         (isell.itemSellTransactions[isell.itemSellTransactions.length-1].status>transactionStates.send
                                         && isell.itemSellTransactions[isell.itemSellTransactions.length-1].status<=transactionStates.accepted)">

                                            <div class="btn centered btn-label" ng-click="viewLabel(isell.id)">View
                                                Shipping
                                                Label
                                            </div>
                                            <f6>Item placed in <b>Medium size box</b></f6>
                                            <!--TODO: remove in production-->
                                            <div ng-click="changeItemStatus(isell.id, transactionStates.receivedInPost)">
                                                ^
                                            </div>
                                        </div>
                                        <!--Send item state-->
                                        <!--Declined item state-->
                                        <div ng-if="subIsell.status==transactionStates.declined && isell.itemSellTransactions[isell.itemSellTransactions.length-1].status==transactionStates.declined">
                                            <f6>Item sell declined! Please contact seller for details!</f6>
                                        </div>
                                        <!--Declined item state-->
                                        <!--Item sold state-->
                                        <div ng-if="subIsell.status==transactionStates.sold && isell.itemSellTransactions[isell.itemSellTransactions.length-1].status|itemSoldBoxSizeVisibility">
                                            <f6>Place item in a <b>Medium size box</b></f6>
                                            <select class="sml selector1" style=" width: 240px;margin: 15px 0 10px 0;">
                                                <option value="">Changing box size costs $</option>
                                                <option value="extralarge">Extra large</option>
                                                <option value="large">Large</option>
                                                <option value="medium">Medium</option>
                                                <option value="Small">Small</option>
                                            </select>

                                            <div>
                                                <div class="btn btn-buy btn-confirm-selling"
                                                     ng-click="changeItemStatus(isell.id, transactionStates.send)">
                                                    Confirm
                                                </div>
                                                <div class="btn"
                                                     ng-click="changeItemStatus(isell.id, transactionStates.declined)">
                                                    Decline
                                                </div>
                                            </div>
                                            <f6>isOpen boxes are supplied free to store owners but pleae allow 10 days
                                                for delivery. If you need a box now they are available from your local
                                                post office.
                                            </f6>
                                        </div>
                                        <div ng-if="subIsell.status==transactionStates.sold && isell.itemSellTransactions[isell.itemSellTransactions.length-1].status==transactionStates.send">
                                            <f6>Item placed in Medium size box</f6>
                                        </div>
                                        <div ng-if="subIsell.status==transactionStates.sold &&
                                         (isell.itemSellTransactions[isell.itemSellTransactions.length-1].status>transactionStates.sold
                                         && isell.itemSellTransactions[isell.itemSellTransactions.length-1].status<=transactionStates.accepted)">
                                            <f6>Item sold!</f6>
                                        </div>
                                        <!--Item sold state-->
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ol>
                </li>
            </ol>
        </div>
    </div>
</div>
